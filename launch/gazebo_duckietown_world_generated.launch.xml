<?xml version="1.0"?>
<launch>
  <!-- The urdf is already generated from the yaml file as that is done by python, which is not available in the RSP singularity image.
   We still need to generate the world file by xacro, as it contains the file:///$(find-pkg-share mirte_gazebo) path, which can be different for every user.
 -->
  <!-- <set_env name="GAZEBO_MODEL_PATH" value="$(find-pkg-share mirte_gazebo)/models"/>
  <set_env name="GAZEBO_MEDIA_PATH" value="$(find-pkg-share mirte_gazebo)/media"/> -->
  <arg name="gui" default="false"/>
  <let name="gazebo_extra" value="--gui-config $(find-pkg-share mirte_gazebo)/config/top_view.config " if="$(var gui)"/>
  <let name="gazebo_extra" value="-s " unless="$(var gui)"/>
  <arg name="duckietown" default="$(find-pkg-prefix mirte_gazebo)/urdf/lab3.world"/>
  <executable cmd="xacro $(var duckietown) -o $(find-pkg-share mirte_gazebo)/worlds/generated.world" cwd="/home" launch-prefix="time" output="screen"/>
  <include file="$(find-pkg-share ros_gz_sim)/launch/gz_sim.launch.py">
    <!-- <arg name="gz_args" value="shapes.sdf"/> -->
    <arg name="gz_args" value="-r $(var gazebo_extra) $(find-pkg-share mirte_gazebo)/worlds/generated.world"/>
  </include>
  <node name="image_bridge" pkg="ros_gz_image" exec="image_bridge" args="/top_down_camera/image_raw" output="screen"/>
</launch>
